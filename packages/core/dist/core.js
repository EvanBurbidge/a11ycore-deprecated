"use strict";const admin=require("firebase-admin"),{normaliseBuild}=require("@a11ycore/utils");module.exports={configureFirebase};function configureFirebase(a,b,c={}){const d=admin.initializeApp({databaseURL:b,credential:admin.credential.cert(a)}),e=d.firestore(),f=e.collection(c.buildsDb),g=e.collection(c.projectsDb);return(a,b)=>new Promise((c,d)=>{if(!a)throw Error("you must supply a project id");const e=normaliseBuild(a,b,admin);g.doc(a).get().then(a=>{if(!a.empty)f.add(e).then(c).catch(d);else throw d(),Error("that project does not exist")}).catch(a=>{throw d(),console.error(a),Error("that project does not exist")})})}